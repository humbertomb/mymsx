10 '*************************
15 '*                       *
20 '*      SKRAM OMEGA      *
25 '*                       *
30 '*     MSX-CLUB-1987     *
35 '*                       *
40 '*   (C) H.MartЁnez      *
45 '*                       *
50 '*************************
70 CLEAR 500,60799!
80 KEY OFF
90 KEY1,"SCREEN 0"+CHR$(13)
100 COLOR 1,5,5
110 ON STOP GOSUB 1300
120 STOP ON
130 SCREEN 1,2,0
140 DEF FN L(L)=6167+(VPEEK(L)\8)*32
150 IF PEEK(62182!)=201 THEN 190
160 POKE 62182!,201
170 POKE 62180!,10
180 POKE 62181!,0
190 DEFINT P
200 WIDTH 32
210 ON ERROR GOTO 3120
220 GOSUB 1590
230 GOSUB 2260
240 GOSUB 2370
250 GOSUB 2120
260 GOSUB 2500
270 GOSUB 1020
280 GOSUB 3330
290 GOSUB 3640
300 GOSUB 3830
310 GOSUB 4080
320 GOSUB 2190
330 GOSUB 2020
340 GOSUB 600
350 REM
360 A=USR(0)
370 A=USR2(0)
380 IF DS=0 THEN GOSUB 510
390 SR=STRIG(1) OR STRIG(2) OR STRIG(0)
400 IF SR=-1 AND DS=-1 THEN DS=0:GOSUB 460
410 P=P-1:IF P=0 THEN P=211
420 A=USR1(P)
430 VPOKE 6924,200
440 IF VDP(8)=191 THEN GOSUB 930
450 GOTO 360
460 REM
470 BOM=BOM-1:LOCATE 13,1:PRINT USING" ###";BOM:IF BOM=0 THEN 1190
480 POKE 62183!,VPEEK(6912)+2
490 VPOKE 6924,VPEEK(6912)+12
500 RETURN
510 REM
520 A=USR(0)
530 A=USR2(0)
540 POKE 62183!,PEEK(62183!)+7
550 VPOKE 6924,PEEK(62183!)
560 IF VPEEK(FN L(6924))=113 OR VPEEK(FN L(6924))=114 THEN GOSUB 1070:GOSUB 1130
570 IF VPEEK(FN L(6924))=120 OR VPEEK(FN L(6924))=121 THEN GOSUB 1070:GOSUB 1160
580 IF VPEEK(6924)>165 THEN DS=-1:VPOKE 6924,209:A=USR3(49)
590 RETURN
600 REM
610 X=175:Y=46
620 S=0:P=211
630 DS=-1
640 VPOKE 6912,Y
650 VPOKE 6913,X
660 VPOKE 6914,0
670 VPOKE 6915,12
680 VPOKE 6916,Y
690 VPOKE 6917,X+16
700 VPOKE 6918,4
710 VPOKE 6919,12
720 VPOKE 6920,Y
730 VPOKE 6921,X+3
740 VPOKE 6922,8
750 VPOKE 6923,1
760 VPOKE 6924,209
770 VPOKE 6925,X+9
780 VPOKE 6926,12
790 VPOKE 6927,1
800 VPOKE 6928,100
810 VPOKE 6929,174
820 VPOKE 6930,16
830 VPOKE 6931,14
840 VPOKE 6932,78
850 VPOKE 6933,84
860 VPOKE 6934,16
870 VPOKE 6935,14
880 VPOKE 6936,54
890 VPOKE 6937,4
900 VPOKE 6938,16
910 VPOKE 6939,14
920 RETURN
930 REM
940 IF DS THEN RETURN 1190
950 VPOKE 6926,200
960 FORI=1TO10
970 PP=VDP(8)
980 NEXT
990 IF PP=191 THEN RETURN 1190
1000 VPOKE 6926,12
1010 RETURN
1020 REM
1030 P1=0:FORI=61100! TO 61342!:P1=P1+1:POKE I,ASC(MID$(PB$,P1,1)):NEXT
1040 P1=0:FORI=61343! TO 61585!:P1=P1+1:POKE I,ASC(MID$(PD$,P1,1)):NEXT
1050 P1=0:FORI=61586! TO 61828!:P1=P1+1:POKE I,ASC(MID$(PE$,P1,1)):NEXT
1060 RETURN
1070 REM
1080 DS=-1:VPOKE 6924,209
1090 A=USR3(6)
1100 PUN=PUN+25
1110 LOCATE 19,3:PRINT USING" #####";PUN
1120 RETURN
1130 REM
1140 Q=61343!+P+23
1150 GOTO 1170
1160 Q=61586!+P+23
1170 POKE Q,128
1180 RETURN
1190 REM
1200 A=USR3(6)
1210 GOSUB 1420
1220 GOSUB 1970
1230 LOCATE 8,9:PRINT "- FIN DE JUEGO -"
1240 LOCATE 8,11:PRINT "PULSA  '";CHR$(253);"' O '";CHR$(254);"' "
1250 IF PEEK(62180!)+PEEK(62181!)*256<PUN THEN POKE 62181!,INT(PUN/256):POKE 62180!,PUN MOD 256
1260 LOCATE 8,13:PRINT "RECORD :";PEEK(62180!)+PEEK(62181!)*256;"PTOS."
1270 H$=INKEY$:IF NOT(H$="S" OR H$="N" OR H$="s" OR H$="n") THEN 1270
1280 IF NOT(H$="S" OR H$="s") THEN 1300
1290 GOTO 1350
1300 REM
1310 SCREEN 0
1320 WIDTH 40
1330 COLOR 15,4,4
1340 END
1350 REM
1360 GOSUB 1590
1370 GOSUB 1040
1380 GOSUB 2190
1390 GOSUB 2020
1400 GOSUB 600
1410 GOTO 350
1420 REM
1430 FORI=1 TO 19
1440 VPOKE 6914,0
1450 VPOKE 6918,4
1460 VPOKE 6922,8
1470 FORJ=0 TO 35
1480 NEXT J
1490 VPOKE 6914,20
1500 VPOKE 6918,20
1510 VPOKE 6922,20
1520 FORJ=0 TO 35
1530 NEXT J
1540 NEXT I
1550 VPOKE 6912,208
1560 VPOKE 6916,209
1570 VPOKE 6920,209
1580 RETURN
1590 REM
1600 CLS:GOSUB 1900
1610 VPOKE 6912,208
1620 LOCATE 1,0:PRINT "XWWWWWWWWWWWWWWWWWWWWWWWWWWWWY"
1630 FOR I=1 TO 20
1640 LOCATE 1,I:PRINT "V"
1650 LOCATE 30,I:PRINT "V"
1660 NEXT I
1670 LOCATE 1,21:PRINT "ZWWWWWWWWWWWWWWWWWWWWWWWWWWWW["
1680 LOCATE 3,8 :PRINT " ллл л  л ллл    лл  л   л"
1690 LOCATE 3,9 :PRINT "у    у  у у  у  у  у у   у"
1700 LOCATE 3,10:PRINT "л    л л  л  л  л  л лл лл"
1710 LOCATE 3,11:PRINT "у    у у  у  у  у  у у у у"
1720 LOCATE 3,12:PRINT "лллл лл   ллл   лллл л л л"
1730 LOCATE 3,13:PRINT "   у у у  у у   у  у у   у"
1740 LOCATE 3,14:PRINT "   л л л  л  л  л  л л   л"
1750 LOCATE 3,15:PRINT "   у у  у у   у у  у у   у"
1760 LOCATE 3,16:PRINT "ллл  л  л л   л л  л л   л"
1770 LOCATE 4,3:PRINT "HUMBERTO MARTINEZ BARBERA"
1780 LOCATE 7,5:PRINT "    PRESENTA:"
1790 LOCATE 8,19:PRINT "PULSA EL ESPACIO"
1800 IF NOT STRIG(0) THEN 1800
1810 LOCATE 7,19:PRINT "ESPERA UN MOMENTO"
1820 GOSUB 1840
1830 RETURN
1840 REM
1850 SOUND 7,90:SOUND 11,0:SOUND 12,0
1860 PLAY"v15t200s3m5000l8n40.l16n43l4n43l8n40.l16n38l4n36l8n38.l16n40l8n43.l16n40l2n38l8n40.l16n43l4n43l8n40.l16n38l4n36l8n38.l16n40l8n38.l16n36l2n36"
1870 PLAY"l8n45.l16n48l4n48l8n47l8n43l4n45l8n45l8n48l8n47l8n43l2n45l8n45.l16n48l4n48l8n47l8n43l4n45l8n45l8n48l8n47l8n43l2n45l8n40.l16n43l4n43l8n40.l16n38l4n36l8n38.l16n40l8n43.l16n40l2n38"
1880 PLAY"l8n40.l16n43l4n43l8n48.l16n50l4n52l8n50.l16n48l8n50l8n45l2n48l8n50.l16n48l8n50l8n45l2n48l4n50.l8n48l4n50l4n45l1n48."
1890 RETURN
1900 REM
1910 VPOKE 8220,255
1920 VPOKE 8200,72
1930 VPOKE 8201,72
1940 VPOKE 8202,72
1950 VPOKE 8203,72
1960 RETURN
1970 REM
1980 VPOKE 8223,245
1990 PK=2032:FORI=624 TO 631:VPOKE PK,VPEEK(I):PK=PK+1:NEXT
2000 PK=2024:FORI=664 TO 671:VPOKE PK,VPEEK(I):PK=PK+1:NEXT
2010 RETURN
2020 REM
2030 LOCATE 4,0:PRINT"XWWWWWWWWWWWWWRWWWWWWWWY"
2040 LOCATE 4,1:PRINT"V BOMBAS:     V SKRAM ъV"
2050 LOCATE 4,2:PRINT"TWWWWWWWWWWWWWQWWWWWWWWS"
2060 LOCATE 4,3:PRINT"V   PUNTUACION:        V"
2070 LOCATE 4,4:PRINT"ZWWWWWWWWWWWWWWWWWWWWWW["
2080 BOM=50:PUN=0
2090 LOCATE 13,1:PRINT USING" ###";BOM
2100 LOCATE 19,3:PRINT USING" #####";PUN
2110 RETURN
2120 REM
2130 PA$=STRING$(32,97)
2140 PB$="bccdefhgfhhhgfgdfdehcbcdihgbhgdfeghfbhgdfeihbibhgfefgbchdihifegdcgdbgheihgdhbcihdgebdgchihdgccgbdbbdgehdihdhiihdbcbchdbecbhcbdhehcihdbchdihdbchbhdcedcfgfghfgfdcihgbcghfgfdefcfdghihfighbgfhgcbfgiihfgfhgegfdbfcgbcgbgfdhihdihicbgfdgfegedfdgfbhchf"
2150 PD$="jjqrjzjstuvjzjzjzjqrjjqrjjqrjzjzjzjzqrjjqrjjqrjjqrjzzzjzjstuvjstuvjjzjqrjjqrjjqrjzjzjstuvjjstuvjjstuvjjqrjzzjqrjzjqrjzjqrjzjstuvjzzjstuvjjjjstuvjjqrjzjstuvjzjqrjzjzjzjjjqrjjjstuvjzjqrjzjjstuvjzzjzzjjqrjjqrjjzjqrjzzjjqrjzjstuvjzjzjzjqrjjqrjjqrj"
2160 PE$="zjxyjzjzjzjstuvjzjxyjzxyjjxyjzjzjzjjxyzzxyzzxyzzxyjjstuvjzjzjzjzjzjzjzxyjzxyjzxyjzjzjzjzjzjzjzjzjzjzjzjxyjzjzxyjzzxyjzzxyjzjzjzjzjzjzjzjzjzjzjzjjjxyjjzjzjzjzjxyjjjstuvjjxyjjzjzjzjzjxyjjzjzjzjjstuvjzjxyjjxyjjzjxyjzzzjxyjzjzjzjstuvjzjxyjzxyjjxyj"
2170 PC$=STRING$(32,"j")
2180 RETURN
2190 REM
2200 CLS
2210 LOCATE 0,21:PRINT PA$
2220 FOR I=17 TO 20
2230 LOCATE 0,I:PRINT PC$
2240 NEXT I
2250 RETURN
2260 REM
2270 RESTORE 2570
2280 SPT=5
2290 FOR I=0 TO SPT
2300 S$="":FOR J=1 TO 32
2310 READ A$
2320 S$=S$+CHR$(VAL("&H"+A$))
2330 NEXT J
2340 SPRITE$(I)=S$
2350 NEXT I
2360 RETURN
2370 REM
2380 RESTORE 2880
2390 CR=31
2400 FOR I=97 TO 97+CR
2410 IF (I>97+9) AND (I<97+16) THEN 2480
2420 IF (I>97+21) AND (I<97+23) THEN 2480
2430 IF (I>97+25) AND (I<97+31) THEN 2480
2440 FOR J=0 TO 7
2450 READ A$
2460 VPOKE I*8+J,VAL("&H"+A$)
2470 NEXT J
2480 NEXT I
2490 RETURN
2500 REM
2510 VPOKE 8204,101
2520 VPOKE 8205,101
2530 VPOKE 8206,54
2540 VPOKE 8207,38
2550 VPOKE 8208,150
2560 RETURN
2570 REM
2580 DATA 0,0,0,0,0,3,7,7
2590 DATA 7,7,3,0,0,0,0,0
2600 DATA 0,0,0,0,0,80,C0,FF
2610 DATA FF,E0,FF,0,0,0,0,0
2620 REM
2630 DATA 0,0,0,0,0,C0,FF,FF
2640 DATA FF,1F,FE,0,0,0,0,0
2650 DATA 0,0,0,38,78,F8,F8,FC
2660 DATA F8,F0,0,0,0,0,0,0
2670 REM
2680 DATA 0,0,0,0,1,3,41,C0
2690 DATA C0,40,0,0,0,0,0,0
2700 DATA 0,0,0,F0,F8,F8,F8,0
2710 DATA 0,FF,0,0,0,0,0,0
2720 REM
2730 DATA 1,1E,1,0,0,0,0,0
2740 DATA 0,0,0,0,0,0,0,0
2750 DATA 0,0,0,0,0,0,0,0
2760 DATA 0,0,0,0,0,0,0,0
2770 REM
2780 DATA 0,8,7,8,0,0,1,0
2790 DATA 1,0,0,8,7,8,0,0
2800 DATA 0,0,80,0,0,0,0,F0
2810 DATA 0,0,0,0,80,0,0,0
2820 REM
2830 DATA 0,10,3C,10,0,38,11,17
2840 DATA 1F,FF,6B,4C,4,0,0,0
2850 DATA 0,0,15,0E,84,C0,C0,0
2860 DATA 0,0,80,C0,4C,1C,8,0
2870 REM
2880 REM
2890 DATA FF,FF,FF,FF,FF,FF,FF,55
2900 DATA 0,0,0,0,45,EF,FF,FF
2910 DATA 0,0,6,F,9F,FF,FF,FF
2920 DATA 0,0,0,8,9C,FE,FF,FF
2930 DATA 0,0,0,11,BB,FF,FF,FF
2940 DATA 0,0,0,0,80,C8,FE,FF
2950 DATA 0,0,0,0,1,23,77,FF
2960 DATA 0,0,0,0,0,0,11,FF
2970 DATA 0,10,18,38,7D,FF,FF,FF
2980 DATA FF,FF,FF,FF,FF,FF,FF,FF
2990 REM
3000 DATA 0,0,7,1F,1F,7,3,7F
3010 DATA 0,0,80,C0,FF,C0,80,FE
3020 DATA 0,0,3F,0,3,7,7,3
3030 DATA 0,80,F0,80,60,B0,8C,3
3040 DATA 0,0,0,80,F8,7C,7F,30
3050 DATA 0,80,40,40,78,FC,FC,30
3060 REM
3070 DATA FF,7F,3F,0,0,0,0,0
3080 DATA FF,FE,FC,0,0,0,0,0
3090 DATA 0,C,C,8,E,8,14,22
3100 REM
3110 DATA 0,CE,48,5E,7C,D4,17,30
3120 REM
3130 SCREEN 0
3140 COLOR 15,4,4
3150 BEEP:BEEP:BEEP
3160 IF ERL<20000 THEN A$=" en linea :"+STR$(ERL) ELSE A$=""
3170 LOCATE 0,0:PRINT"ERROR no definido ";A$
3180 LOCATE 0,0
3190 IF ERR=5 THEN PRINT"Llamada de funcion,ilegal ";A$
3200 IF ERR=1 THEN PRINT"Error de NEXT sin FOR ";A$
3210 IF ERR=4 THEN PRINT"Faltan DATAs ";A$
3220 IF ERR=7 THEN PRINT"Fuera de memoria ";A$
3230 IF ERR=14 THEN PRINT"Fuera del espacio de variables ";A$
3240 IF ERR=6 THEN PRINT"Fuera del margen ";A$
3250 IF ERR=3 THEN PRINT"Error de RETURN sin GOSUB ";A$
3260 IF ERR=2 THEN PRINT"Error sint ctico ";A$
3270 IF ERR=10 THEN PRINT"Array redimensionado ";A$
3280 IF ERR=15 THEN PRINT"String demasiado largo ";A$
3290 IF ERR=8 THEN PRINT"Linea no definida ";A$
3300 IF ERR=20 THEN PRINT"Verifica el programa "
3310 LOCATE 0,1
3320 END
3330 REM
3340 RESTORE 3340
3350 PK#=62000!
3360 READ A$:IF A$="#" THEN 3440
3370 POKE PK#,VAL("&H"+A$)
3380 PK#=PK#+1
3390 GOTO 3360
3400 DATA 06,05,3A,F8,F7,CD,D5
3410 DATA 00,FE,01,CC,58,F2,FE
3420 DATA 05,CC,80,F2,10,ED,C9
3430 DATA #
3440 DEFUSR=62000!
3450 PK#=62040!
3460 READ A$:IF A$="#" THEN 3540
3470 POKE PK#,VAL("&H"+A$)
3480 PK#=PK#+1
3490 GOTO 3460
3500 DATA 21,00,1B,CD,4A,00,FE,28
3510 DATA D8,3D,CD,4D,00,23,23,23
3520 DATA 23,CD,4D,00,23,23,23,23
3530 DATA CD,4D,00,C9,#
3540 PK#=62080!
3550 READ A$:IF A$="#" THEN 3630
3560 POKE PK#,VAL("&H"+A$)
3570 PK#=PK#+1
3580 GOTO 3550
3590 DATA 21,00,1B,CD,4A,00,FE,68
3600 DATA D0,3C,CD,4D,00,23,23,23
3610 DATA 23,CD,4D,00,23,23,23,23
3620 DATA CD,4D,00,C9,#
3630 RETURN
3640 REM
3650 RESTORE 3650
3660 PK#=62120!
3670 READ A$:IF A$="#" THEN 3810
3680 POKE PK#,VAL("&H"+A$)
3690 PK#=PK#+1
3700 GOTO 3670
3710 DATA 21,11,1B,06,0A,CD,4A
3720 DATA 00,3C,CD,4D,00,10,F6
3730 REM
3740 DATA 21,15,1B,06,0A,CD,4A
3750 DATA 00,3C,CD,4D,00,10,F6
3760 REM
3770 DATA 21,19,1B,06,0A,CD,4A
3780 DATA 00,3C,CD,4D,00,10,F6
3790 REM
3800 DATA C9,#
3810 DEFUSR2=62120!
3820 RETURN
3830 REM
3840 RESTORE 3840
3850 PK#=61000!
3860 READ A$:IF A$="#" THEN 4060
3870 POKE PK#,VAL("&H"+A$)
3880 PK#=PK#+1
3890 GOTO 3860
3900 DATA ED,6B,F8,F7,11,AC
3910 DATA EE,19,11,00
3920 DATA 1A,01,20,00,CD,5C
3930 DATA 00
3940 REM
3950 DATA ED,6B,F8,F7,11,9F
3960 DATA EF,19,11,40
3970 DATA 1A,01,20,00,CD,5C
3980 DATA 00
3990 REM
4000 DATA ED,6B,F8,F7,11,92
4010 DATA F0,19,11,60
4020 DATA 1A,01,20,00,CD,5C
4030 DATA 00
4040 REM
4050 DATA C9,#
4060 DEFUSR1=61000!
4070 RETURN
4080 REM
4090 RESTORE 4090
4100 PK#=61840!
4110 READ A$:IF A$="#" THEN 4350
4120 POKE PK#,VAL("&H"+A$)
4130 PK#=PK#+1
4140 GOTO 4110
4150 DATA ED,6B,F8,F7
4160 DATA 3E,0C,5E,CD,93,00
4170 DATA 3E,0B,1E,00,CD,93,00
4180 DATA 3E,00,1E,00,CD,93,00
4190 DATA 3E,01,1E,05,CD,93,00
4200 DATA 3E,02,1E,00,CD,93,00
4210 DATA 3E,03,1E,0D,CD,93,00
4220 DATA 3E,04,1E,FF,CD,93,00
4230 DATA 3E,05,1E,0F,CD,93,00
4240 DATA 3E,06,1E,1E,CD,93,00
4250 DATA 3E,07,1E,00,CD,93,00
4260 DATA 3E,08,1E,10,CD,93,00
4270 DATA 3E,09,1E,10,CD,93,00
4280 DATA 3E,0A,1E,10,CD,93,00
4290 DATA 3E,0D,1E,00,CD,93,00
4300 DATA 06,FF,00,11,FC
4310 DATA 06,FF,00,11,FC
4320 DATA 3E,0C,1E,38,CD,93,00
4330 DATA 3E,0D,1E,00,CD,93,00
4340 DATA C9,#
4350 DEFUSR3=61840!
4360 RETURN

